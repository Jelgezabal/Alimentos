// Base de datos de alimentos
const alimentos = [
  {
    categoria: "Carnes",
    nombre: "Carne de Hamburguesa",
    kcal: 240,
    proteinas: 19.17,
    hidratos: 0.5,
    grasas: 18.33,
    fibra: 0,
    calcio: 22,
    hierro: 2.7,
    magnesio: 20,
    potasio: 315,
    vitamina_a: 0,
    vitamina_c: 0,
    vitamina_d: 0,
    vitamina_e: 0.4,
    folato: 8,
    vitamina_b12: 2.5,
    notas: ''
  },
  {
    categoria: "Carnes",
    nombre: "Entrecot de Ternera",
    kcal: 250,
    proteinas: 25,
    hidratos: 0,
    grasas: 16,
    fibra: 0,
    calcio: 20,
    hierro: 2.9,
    magnesio: 23,
    potasio: 330,
    vitamina_a: 0,
    vitamina_c: 0,
    vitamina_d: 0,
    vitamina_e: 0.3,
    folato: 9,
    vitamina_b12: 2.8,
    notas: ''
  }
];

function BuscadorAlimentos() {
  // Estado del componente
  const [terminoBusqueda, setTerminoBusqueda] = React.useState('');
  const [categoria, setCategoria] = React.useState('');
  const [resultados, setResultados] = React.useState(alimentos);
  const [ordenamiento, setOrdenamiento] = React.useState({ 
    columna: null, 
    direccion: 'asc' 
  });

  // Función de búsqueda
  const buscarAlimentos = (terminoBusqueda, categoria, resultados) => {
    return resultados.filter(alimento => 
      (terminoBusqueda === '' || alimento.nombre.toLowerCase().includes(terminoBusqueda.toLowerCase())) &&
      (categoria === '' || alimento.categoria.toLowerCase() === categoria.toLowerCase())
    );
  };

  // Obtener categorías únicas
  const categorias = Array.from(new Set(alimentos.map(a => a.categoria)));

  // Función de ordenamiento
  const resultadosOrdenados = React.useMemo(() => {
    if (!ordenamiento.columna) return resultados;

    return [...resultados].sort((a, b) => {
      const valorA = a[ordenamiento.columna];
      const valorB = b[ordenamiento.columna];

      // Manejo de ordenamiento para strings
      if (typeof valorA === 'string' && typeof valorB === 'string') {
        return ordenamiento.direccion === 'asc'
          ? valorA.localeCompare(valorB)
          : valorB.localeCompare(valorA);
      }

      // Manejo de ordenamiento para números
      if (typeof valorA === 'number' && typeof valorB === 'number') {
        return ordenamiento.direccion === 'asc' 
          ? valorA - valorB 
          : valorB - valorA;
      }

      return 0;
    });
  }, [resultados, ordenamiento]);

  // Función para manejar el ordenamiento
  const handleOrdenar = (columna) => {
    setOrdenamiento(prev => ({
      columna,
      direccion: prev.columna === columna && prev.direccion === 'asc' 
        ? 'desc' 
        : 'asc'
    }));
  };

  const handleBuscar = () => {
    const resultadosFiltrados = buscarAlimentos(terminoBusqueda, categoria, alimentos);
    setResultados(resultadosFiltrados);
  };

  return (
    React.createElement('div', { className: "container mx-auto p-4" },
      React.createElement('h1', { className: "text-2xl font-bold mb-4" }, "Buscador de Alimentos"),
      
      React.createElement('div', { className: "flex space-x-2 mb-4" },
        React.createElement('input', {
          type: "text",
          value: terminoBusqueda,
          onChange: (e) => setTerminoBusqueda(e.target.value),
          placeholder: "Buscar alimento",
          className: "input input-bordered w-full max-w-xs"
        }),
        
        React.createElement('select', {
          value: categoria,
          onChange: (e) => setCategoria(e.target.value),
          className: "select select-bordered w-full max-w-xs"
        },
          React.createElement('option', { value: "" }, "Todas las categorías"),
          categorias.map((cat, index) => 
            React.createElement('option', { key: index, value: cat }, cat)
          )
        ),
        
        React.createElement('button', {
          onClick: handleBuscar,
          className: "btn btn-primary"
        }, "Buscar")
      ),

      resultadosOrdenados.length > 0 
        ? React.createElement('div', { className: "overflow-x-auto" },
            React.createElement('table', { className: "table w-full table-compact" },
              React.createElement('thead', null,
                React.createElement('tr', null,
                  React.createElement('th', { onClick: () => handleOrdenar('nombre') }, "Nombre"),
                  React.createElement('th', { onClick: () => handleOrdenar('categoria') }, "Categoría"),
                  React.createElement('th', { onClick: () => handleOrdenar('kcal') }, "Calorías (kcal)"),
                  React.createElement('th', { onClick: () => handleOrdenar('proteinas') }, "Proteínas (g)"),
                  React.createElement('th', { onClick: () => handleOrdenar('grasas') }, "Grasas (g)"),
                  React.createElement('th', { onClick: () => handleOrdenar('hidratos') }, "Hidratos (g)"),
                  React.createElement('th', { onClick: () => handleOrdenar('fibra') }, "Fibra (g)"),
                  React.createElement('th', { onClick: () => handleOrdenar('potasio') }, "Potasio (mg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('calcio') }, "Calcio (mg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('hierro') }, "Hierro (mg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('magnesio') }, "Magnesio (mg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('vitamina_a') }, "Vitamina A (µg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('vitamina_c') }, "Vitamina C (mg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('vitamina_d') }, "Vitamina D (µg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('vitamina_e') }, "Vitamina E (mg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('folato') }, "Folato (µg)"),
                  React.createElement('th', { onClick: () => handleOrdenar('vitamina_b12') }, "Vitamina B12 (µg)")
                )
              ),
              React.createElement('tbody', null,
                resultadosOrdenados.map((alimento, index) => 
                  React.createElement('tr', { key: index },
                    React.createElement('td', null, alimento.nombre),
                    React.createElement('td', null, alimento.categoria),
                    React.createElement('td', { className: "text-center" }, alimento.kcal.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.proteinas.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.grasas.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.hidratos.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.fibra.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.potasio.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.calcio.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.hierro.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.magnesio.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.vitamina_a.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.vitamina_c.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.vitamina_d.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.vitamina_e.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.folato.toFixed(1)),
                    React.createElement('td', { className: "text-center" }, alimento.vitamina_b12.toFixed(1))
                  )
                )
              )
            )
          )
        : React.createElement('p', null, "No se encontraron alimentos")
    )
  );
}

// Exportar el componente para que pueda ser usado
export default BuscadorAlimentos;
